# Telegram Bot for Notifications

**Разработчик**: Милютин Никита Александрович

## Описание

Этот Telegram-бот предназначен для отправки уведомлений в чаты о событиях в непубличной информационной системе. Бот может автоматически отправлять сообщения в указанные чаты Telegram, помогая оперативно информировать о важных событиях.

## Локальный тестовый деплой

Для тестирования на локальной машине выполните следующие шаги:

1. Перейдите в директорию с файлом Dockerfile.
2. Выполните команды:

   docker build -t terminal_bot_cron_image .
   docker run -d --name terminal_bot_cron terminal_bot_cron_image

Эти команды создадут и запустят контейнер бота на локальной машине для тестирования.

## Деплой на сервер

Деплой на сервере выполняется с использованием docker-compose, который запускается через скрипт deploy.sh. Убедитесь, что все необходимые конфигурационные файлы и директории подготовлены (см. ниже).

## Настройка конфигурационных файлов

Конфигурационные файлы находятся в директории config_files. Следующие файлы требуют ручной настройки:

- chat_id.json: Содержит словарь с соответствием между ID СМИ и их CHAT ID в Telegram.
- bearer_token.json: Файл для хранения токена аутентификации. При первом запуске его необходимо добавить вручную, далее токен будет автоматически обновляться раз в день с помощью cron.
- api_urls.json: Содержит URL-адреса для доступа к API. Обновите их в случае изменений.

## Подготовка данных

Перед первым запуском убедитесь, что файлы в ./bot/data_files правильно настроены:

- saved_messages.json: Пустой словарь для сохраненных сообщений.
- old_info_units.json: Пустой словарь для хранения предыдущих информационных блоков. Важно, чтобы при первом запуске файл оставался пустым, иначе в чат могут уйти сообщения с устаревшими данными.

## Развертывание

Для развертывания бота на сервере запустите скрипт:

   sh deploy.sh

Скрипт настроит и запустит Docker-контейнеры бота, обеспечивая автоматическое уведомление в чаты о событиях в непубличной системе.

## Технические требования

- Docker и Docker Compose должны быть установлены на сервере.
- Папка config_files должна содержать корректно настроенные файлы, описанные выше.
- Папка ./bot/data_files должна содержать необходимые JSON-файлы в требуемом формате.